The whole program with some simplifications and in a single notebook. Theory is not included here. 
